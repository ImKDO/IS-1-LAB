# City Management System

Информационная система для управления объектами класса City с использованием Spring MVC и EclipseLink.

## Функциональность

### Основные операции
- ✅ Создание нового города
- ✅ Получение информации о городе по ID
- ✅ Обновление города (модификация атрибутов)
- ✅ Удаление города
- ✅ Отображение списка городов в виде таблицы с пагинацией
- ✅ Фильтрация и сортировка по любым колонкам
- ✅ Real-time обновления через WebSocket

### Специальные операции
- ✅ Удаление городов по климату
- ✅ Расчет средней высоты над морем
- ✅ Поиск городов по названию (подстрока)
- ✅ Переселение населения между городами
- ✅ Переселение в город с наименьшим населением

## Технологии

- **Backend**: Spring Boot 4.0.0-M3, Spring MVC, Spring Data JPA
- **ORM**: EclipseLink 4.0.2
- **Database**: PostgreSQL 15
- **Frontend**: Thymeleaf, Bootstrap 5, JavaScript
- **Real-time**: WebSocket (STOMP)
- **Build Tool**: Gradle

## Запуск приложения

### 1. Запуск PostgreSQL

```bash
docker-compose up -d
```

### 2. Настройка переменных окружения

Создайте файл `.env` или установите переменные окружения:

```bash
export DB_USERNAME=postgres
export DB_PASSWORD=postgres
```

### 3. Запуск приложения

```bash
./gradlew bootRun
```

Приложение будет доступно по адресу: http://localhost:8080

## Использование

### Веб-интерфейс

1. **Главная страница** (`/`) - список всех городов с возможностью:
   - Просмотра, редактирования и удаления городов
   - Фильтрации по названию
   - Сортировки по любому полю
   - Пагинации

2. **Специальные операции** (`/special-operations`) - выполнение специальных операций:
   - Удаление городов по климату
   - Расчет средней высоты над морем
   - Поиск городов по названию
   - Переселение населения

### REST API

#### Основные операции
- `GET /api/cities` - получить список городов (с пагинацией и фильтрацией)
- `GET /api/cities/{id}` - получить город по ID
- `POST /api/cities` - создать новый город
- `PUT /api/cities/{id}` - обновить город
- `DELETE /api/cities/{id}` - удалить город

#### Специальные операции
- `GET /api/cities/search?name={name}` - поиск по названию
- `GET /api/cities/climate/{climate}` - получить города по климату
- `GET /api/cities/statistics/average-sea-level` - средняя высота над морем
- `POST /api/cities/relocate/{fromId}/{toId}` - переселение населения
- `POST /api/cities/relocate-to-lowest/{fromId}` - переселение в город с наименьшим населением
- `DELETE /api/cities/climate/{climate}` - удаление по климату

## Модель данных

### City (Город)
- `id` - уникальный идентификатор (автогенерация)
- `name` - название города (обязательное)
- `coordinates` - координаты (обязательные)
- `creationDate` - дата создания (автогенерация)
- `area` - площадь (обязательное, > 0)
- `population` - население (обязательное, > 0)
- `establishmentDate` - дата основания
- `capital` - является ли столицей
- `metersAboveSeaLevel` - высота над морем
- `climate` - климат (обязательное)
- `government` - правительство
- `standardOfLiving` - уровень жизни (обязательное)
- `governor` - губернатор (обязательный)

### Coordinates (Координаты)
- `x` - координата X (обязательная, > -687)
- `y` - координата Y (обязательная, > -449)

### Human (Человек)
- `height` - рост (обязательный, > 0)

### Перечисления
- `Climate`: RAIN_FOREST, TROPICAL_SAVANNA, OCEANIC, POLAR_ICECAP
- `Government`: CORPORATOCRACY, PUPPET_STATE, MERITOCRACY
- `StandardOfLiving`: VERY_LOW, ULTRA_LOW, NIGHTMARE

## Особенности реализации

1. **Валидация**: Все ограничения полей проверяются на уровне модели и DTO
2. **Real-time обновления**: WebSocket уведомления о всех изменениях
3. **Транзакционность**: Все операции с БД выполняются в транзакциях
4. **Обработка ошибок**: Глобальный обработчик исключений
5. **Пагинация**: Эффективная работа с большими объемами данных
6. **Фильтрация**: Поиск по полному совпадению строк

## Требования к системе

- Java 21+
- PostgreSQL 15+
- Docker (для запуска БД)
- Gradle 8+

## Лицензия

Этот проект создан в учебных целях.

